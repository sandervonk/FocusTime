function allFromDoc(e){casheUserDoc(e);try{makeTasksFromDoc(e),setupFieldsFromDoc(e)}catch(e){console.warn("could not setup app pages from doc",e)}}function casheUserDoc(e){localStorage["user-data"]=JSON.stringify(e.data()),userDocCache=e.data()}function doClassSelect(){let e=getClassJSON(),a=$('[data-role="task-info-tag"]').html("<option disabled selected hidden value=''>Choose a Class</option>");delete e.other,e.other="Other";for(let t of Object.keys(e))a.append(`<option value="${t}">${e[t]}</option>`)}function setupFieldsFromDoc(e){if(e.exists){$("[data-auth-role='name']").text(e.data().name.split(" ")[0]),userDocCache=e.data();try{let a=0,t=0;for(task of e.data().tasks?e.data().tasks:[])(task.date&&!parseInt(task.date)||task.date&&new Date(task.date).getTime()<=new Date((new Date).toLocaleDateString("en-ca")).getTime()+day_ms)&&(a++,task.is_completed&&t++);let o=parseInt(100*t/a);o=isNaN(o)?0:o,$('[data-role="progress-percentage"]').text(o),$('[data-role="progress-bar"]').css("width",`${o}%`),$('[data-role="progress-completed"]').text(t),$('[data-role="progress-total"]').text(a)}catch(e){console.error(e)}}else new ErrorToast("Error","Userdoc does not exist",3e3);doClassSelect()}const firebaseConfig={apiKey:"AIzaSyBtV4ajO6P0PH3aje1J0UedJj8zSYgqy9w",authDomain:"focustime-a18ff.firebaseapp.com",projectId:"focustime-a18ff",storageBucket:"focustime-a18ff.appspot.com",messagingSenderId:"1081184659635",appId:"1:1081184659635:web:c62431e60888334575e8c6",measurementId:"G-N8T6NFR8GN"},baseclasses={other:"Other"};var getClassJSON=function(){let e=baseclasses;try{for(let a in userDocCache.classes)e[a]=userDocCache.classes[a]}catch{e=baseclasses}return e};const app=firebase.initializeApp(firebaseConfig),db=firebase.firestore(),auth=firebase.auth();auth.onAuthStateChanged(e=>{user=e,e?window.location.pathname.includes("/app/")||window.location.pathname.includes("/signup.html")||window.location.pathname.includes("/login.html")?(db.collection("users").doc(user.uid).get().then(allFromDoc),db.collection("users").doc(user.uid).onSnapshot(allFromDoc)):window.location.href="/FocusTime/app/":window.location.pathname.includes("/signup.html")||window.location.pathname.includes("/login.html")||new Toast("Sorry, you need to be signed in to access this page!","default",1e3,"//sander.vonk.one/FocusTime/img/icon/toast/info-locked-icon.svg","./signup.html")});